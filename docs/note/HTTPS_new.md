### 1. HTTPS

> HTTPS = HTTP + TLS(SSL)

**HTTPS解决了三个问题：防窃听、防篡改、身份认证**

**防窃听**：HTTP使用明文传输，双方会话的信息很容易可以被第三方获取到；HTTPS通过结合使用**对称加密算法和非对称加密算法**加密会话的内容，防止被窃听。

**防篡改**：采用**数字签名**技术来保证接收方接收的数据没有被别人修改过。数字签名(**用私钥加密过的摘要**)类似于校验码，会附加在要传输的原信息的尾部，一般通过私钥加密**摘要算法**实现。摘要算法即原文件的一个哈希映射，接收方接收到信息后**对原文件计算得到摘要m**，然后再用对方的**公钥解密数字签名得到摘要n**,通过对比摘要m和摘要n来判断原文件是否被篡改。

![](https://picture-1305610595.cos.ap-guangzhou.myqcloud.com/202206041454820.jpg)

**身份认证**：前两点保证了会话不被第三方获取以及通信内容不被篡改，但是存在**中间人攻击**的风险。需要**数字证书颁发机构(CA)**对服务端的公钥进行加密(使用机构私钥加密)，也就是证书。

![](https://picture-1305610595.cos.ap-guangzhou.myqcloud.com/202206041454821.jpg)

### 2. TLS

TLS协议位于传输层之上，应用层之下

TLS中使用了两种加密技术——对称加密、非对称加密

- 对称加密
  
  概述：对称加密即两边拥有相同的密钥，都知道加密和解密的方法
  
  缺点：密钥可能被黑客拦截，从而可以获取和篡改双方通信信息

- 非对称加密
  
  分为**公钥**和**私钥**，加密时使用公钥，解密时使用私钥(**加密性**)；加密时用私钥，解密时用公钥(**身份验证**，因为私钥是唯一的，可以验证身份的唯一性)

- 摘要算法
  
  使用SHA-1或SHA-2散列函数加密算法，验证数据的**完整性**(对数据进行变换，计算出摘要，通过对比摘要判断是否被篡改)

- TLS握手过程
  
  TLS握手阶段，两端使用非对称加密方式来通信(**非对称加密会话密钥**)，但在正式传输数据时，两端使用对称加密的方式来通信
  
  ![image-20220118212903471](https://picture-1305610595.cos.ap-guangzhou.myqcloud.com/202206041454822.png)
  
  1. 客户端发送数据，包括**随机值**、需要的协议、加密方式
  2. 服务端收到后也生成一个**随机值**，并根据协议和加密方式发送自己的证书(CA)
  3. 客户端收到服务端的证书并验证，再生成一个**随机值**，通过**服务端证书的公钥去加密**并发送给服务端
  4. 服务端收到后用**私钥解密**获得第三个随机值，这样两端都有三个随机值，可以通过这三个随机值按照约定的加密方式生成**会话密钥**

### 3. 中间人攻击

**过程**：中间人伪造一对<mark>公钥和私钥</mark>，然后将<mark>伪造公钥</mark>发送给客户端，客户端用<mark>伪造公钥</mark>加密信息后发送给中间人，中间人使用<mark>伪造私钥</mark>解密后得到客户端发送的消息并篡改。然后中间人伪造成客户端与服务器建立连接，使用服务器的公钥加密篡改后的信息发送给服务器，完成对信息的篡改

**解决方法**：利用<mark>CA证书</mark>进行对服务器身份的认证

**CA证书认证原理**：服务器将公钥发给证书机构申请证书，证书机构生成<mark>机构公钥、机构私钥</mark>，使用<mark>机构私钥</mark>对服务器公钥、证书签名一起打包成证书，重新发回给服务端。客户端在验证服务端身份时，使用对应证书机构的<mark>机构公钥</mark>对证书签名进行解密并验证签名规则，从而确认服务端的身份。